# Web services documentation

## Index
* [General information](#general-information)
  * [Response data structure](#response-data-structure)
  * [Mandatory headers](#mandatory-headers)
  * [Codes](#codes)
    * [General codes](#general-codes)
    * [Fatal error codes](#fatal-error-codes)
* [Social Network API](#social-network-api)
  * [Users](#users)
    * [Create student](#create-student)
    * [Sign in](#sign-in)
    * [Get public user data](#get-public-user-data)
    * [Create user post](#create-user-post)
    * [Create comment in user post](#create-comment-in-user-post)
    * [Search users](#search-users)
    * [Get public user types](#get-public-user-types)
    * [Get majors data](#get-majors-data)
    * [Set follower](#set-follower)
    * [Update profile image](#update-profile-image)
  * [Groups](#groups)
    * [Get information of a group](#get-information-of-a-group)
    * [Search groups](#search-groups)
    * [Create a group](#create-a-group)
    * [Switch group notifications](#switch-group-notifications)
    * [Update group image](#update-group-image)
    * [Add a user to a group](#add-a-user-to-a-group)
    * [Get available permissions for groups](#get-available-permissions-for-groups)
    * [Create group post](#create-group-post)
    * [Create comment in group post](#create-comment-in-group-post)
    * [Get membership information](#get-membership-information)
  * [Posts](#posts)
    * [Get posts for timeline](#get-posts-for-timeline)
    * [Get data of one publication](#get-data-of-one-publication)
    * [Get favorite posts of user](#get-favorite-posts-of-user)
    * [Get comments of a post](#get-comments-of-a-post)
    * [Get publications of a certain group](#get-publications-of-a-certain-group)
    * [Get publication of a user](#get-publication-of-a-user)

## General information

### Response data structure

```json
{
  "code": 0,
  "data": { },
  "messages": [ ]
}
```

* `code`: The exit code of the process. Helpfully to see what exactly happened.
* `data`: The data requested, or the data returned when the execution was correct.
* `messages`: A message array to help the programmer to identify easier what happened with the process.

### Mandatory headers
* **Content-Type**: application/json
* **x-api-key**: [Hash provided by server maintainer]
* **Authorization**: [JWT generated by a call to the signin endpoint of Social Network API]

Authorization header is not always required but it is at most of endpoints. Where it is required will be
mentioned on headers section of the endpoint description. This header is used to authenticate the user
that requests an endpoint.

### Codes

Following codes are common in all endpoints of the **Social Network API** and the **Administration API**.

#### General codes

The kind of codes are negative numbers. They represents errors with the data provided by the client. They DO NOT
represent an invalid combination of data, but a invalid data type, a missing argument, an unauthorized use of the API
or in a special case, an unknown error.

* 0: Success.
* -1: Params are not corrects.
* -2: User token expired.
* -3: User authentication (token) not valid.
* -4: Application not allowed to use the service.
* -5: An unknown error. Check log/crash_reports.log and API log files to see what happened.

#### Fatal error codes

These are server-side errors and must be addressed as soon as possible. If they happen, application keep
working but some important features are not going to work.

* 1000: RSA keys were not found when trying to sign o verify a token.
  * What to do: You need to put the RSA key pair in their right place. Read the [documentation of how to setup the environment](ENV_SETUP.md)
  and read the RSA certs section.

* 1001: Cloudinary credentials were not found when trying to use endpoints which use Cloudinary services.
  * What to do: You need to set the Cloudinary credentials in the .env file. There are two options:
      * Doing manually, read the section Setting up environment variables in the [documentation of how to setup the environment](ENV_SETUP.md). 
      * Using the script for setup the enviroment and add the cloudinary flag options. You can find more info in the [scripts documentation](SCRIPTS.md) in the section Setup environment.

## Social Network API

### Users

#### Create student

##### Description

Create a new student user in the system and return a session token.

##### Endpoint
`/v1/api/social-network/users/signup`

##### Headers

Not more than the mandatories.

##### Method

POST

##### Params

* `firstname`: string
* `lastname`: string
* `email`: string
* `passwd`: string
* `description`: string
* `user_type_id`: int
* `major_id`: int

##### Response data-structure

```json
{
  "username": "jonhdoe",
  "firstname": "John",
  "lastname": "Doe",
  "description": "Hi I'm John Doe",
  "profile_img_src": "",
  "user_type_id": 1,
  "user_type_name": "Estudiante",
  "major_id": 2,
  "major_name": "Data Engineering",
  "student_id": "-_john06",
  "created_at": "2020-07-20T16:31:31.000Z",
  "session_token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjo0LCJpYXQiOjE1OTY3NjYzOTcsImV4cCI6MTU5NzM3MTE5N30.AAuRetvF60kCqMYjUatkvhVKu75WHBGiYAv3K-yw5LOk-WIAWVlwmaXEzC5VVVYlHs3VfteCT52LFpkJSdQPsaCalEmngOx2tqshfwtK7PolRQN7j_Qcvqh-ckhwyPW_oVux5OjBqbbq9XYg3y5uhHpkNur9ouOFbMdPYx95YWp_gR0KfI5n8j7xjOyNLvNEg7X4wxHh7k-APWY8kt9rPTHaOxjUBsBKS-Uf3G4qoWQ1mqqRawH9YkpmNzmqjfj_hnV-Plvl-pAzc5fznkAYWiSFFQtyAPS5r7hAK2uzNxPT38q-Eo_YghukfLhqbPZyCutIf5HDy3VJnAJ2CSLLonAr9_uXqtTizyg4ijv61sFz30HfnbxZ5lsllJm2rggTNQm7XafQNjG1L1uukjLKtO39a-BA1RPZQuv0vnXCihArFdY1NNMCyL4eUehNxlDWj56VyLIq_DqIFtdXHKiuoqEFq7Mr4gkYQI4Qu3hshbjxrD1y_ELJnE44D4qbdVdK"
}
```

##### Codes
* 1: Domain name not allowed.
* 2: Email already exists.
* 3: Username already exists.
* 4: User type doesn't exists.
* 5: Major doesn't exists.
* 6: Student id already exists.

#### Sign in

##### Description

Generates a session token to be used by an user. This token must be sent in the `Authorization` header
of a request that calls to an endpoint that requires user authentication.

##### Endpoint
`/v1/api/social-network/users/signin`

##### Headers

Not more than the mandatories.

##### Method

POST

##### Params

* `username`: string. It can be the username or email.
* `passwd`: string

##### Response data-structure

```json
{
  "username": "jonhdoe",
  "firstname": "John",
  "lastname": "Doe",
  "type_user": "Estudiante",
  "description": "Hi I'm John Doe",
  "profile_img_src": "",
  "created_at": "2020-07-20T16:31:31.000Z",
  "major": "Data Engineering",
  "session_token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjp7ImlkIjoyMH0sImlhdCI6MTU5NTA1MzM5NSwiZXhwIjoxNTk1NjU4MTk1fQ.n39rxTNk6z64hIAh4BmJLucIjawBN0UGuU_IyVgCBa2vkzqsRhntU8YHQXMkmpZyzZTDWlowFSMfaNWOXthcK0O2U5gxKtXB-suRoEOijZu03c7B3BnIBZt4lid7KBhi3WME_JUJIV3xVQQiy-XIW0qMSsG3dJyHDB-jLAv1YL9vrGZdIobsAD0cipUyBrRfez4N824-EtlLjxyHHjsnmGeMMqhebIL3Lkgb-OaHDzqVgEcULRqqXozuGXHYw4a5Qs41eIF2q7zrq1DQueXGuNG-NKnB8gP8Hx_0Z_zT0syI6tfCyfFtF11-BAL7fEOOIBjsRW7grifqbZ3x8OXRiVdRewydvLHDqUqY5B4EdJEAK-q3WvxiolXZ-obYGY48enMuM4kLvrSL19Uu-NYbRk5Q3INoSecIsr2s_Kp2Ac8d-4gYjzCLyad8cmhXRZP8kzLVfdx6wpWvcG5vJB1YVa1rqms-ldsecZNhsTE5eqcv7TDxrSMJPR11RTqDx-DK"
}
```

##### Codes

* 1: Invalid credentials.

#### Get public user data

##### Description

Retrieve the user public information according of the user type. For example, if the user is a student
so within the data will be the major and the email will not show.

##### Endpoint

`/v1/api/social-network/users/data/:username`

##### Headers

Not more than the mandatories.

##### Method

GET

##### Params

* `username`: string.

##### Response data-structure

```json
{
  "username": "jonhdoe",
  "firstname": "John",
  "lastname": "Doe",
  "type_user": "Estudiante",
  "description": "Hi I'm John Doe",
  "profile_img_src": "",
  "created_at": "2020-07-20T16:31:31.000Z",
  "requesting_user_is_follower": true,
  "major": "Data Engineering"
}
```

##### Codes
* 1: Username doesn't exists.

#### Create user post

##### Description

Create a new user post, with a content and/or image.

Or shares a user post or public group post as user post, with an optional content. 
If the referenced post id of the shared post has an integer positive number, the 
referenced post id of the new user post that is going to be saved will be the id 
of the root post.

##### Endpoint

`/v1/api/social-network/users/post`

##### Headers

* `Content-Type`: multipart/form-data
* `Authorization`

##### Method

POST

##### Params

* `content`: string.
* `image`: blob.
* `referenced_post_id`: int. Id of user post or public group post to share.

##### Response data-structure

```json
{
  "id": 128,
  "username": "akali",
  "firstname": "Akali",
  "lastname": "",
  "profile_img_src": "",
  "content": "Hello, world!",
  "img_src": null,
  "post_type": "user",
  "like_counter": 1,
  "created_at": "2021-08-05T05:00:00.000Z",
  "liked_by_user": false,
  "group_name": null,
  "group_id": null,
  "referenced_post_id": 9,
  "referenced_post": {
    "id": 9,
    "username": "ahri",
    "firstname": "Ahri",
    "lastname": "",
    "profile_img_src": "",
    "content": "Prueba",
    "img_src": null,
    "post_type": "group",
    "like_counter": 1,
    "created_at": "2021-07-18T05:00:00.000Z",
    "liked_by_user": false,
    "group_name": "Grupo 1 del usuario 1",
    "group_id": 1
  }
}
```

##### Codes
* 1: No data was sent.
* 2: The post cannot be shared, it belongs to a private group.

#### Create comment in user post

##### Description

Creates a comment made on a post of type 'user'.

The comment can has a content and/or image.

##### Endpoint

`/v1/api/social-network/users/post/:post_id/make-comment`

##### Headers

* `Content-Type`: multipart/form-data
* `Authorization`

##### Method

POST

##### Params

* URl params
  * `post_id`: int.

* Body params
  * `content`: string.
  * `image`: blob.

##### Response data-structure

```json
{
  "post_id": 3,
  "comment_id": 44,
  "user_id": 31,
  "firstname": "johndoe",
  "lastname": "John",
  "username": "Doe",
  "profile_image_src": "",
  "content": "Comment of John in post with id 3",
  "image_src": "https://res.cloudinary.com/someone-cloud/image/upload/v1629060714/zlslbdbzu3fjyiknjm38.jpg",
  "created_at": "2021-08-15"
}
```

##### Codes
* 1: No data was sent.
* 2: Post does not exist.
* 3: Error. This post belongs to a group. Use the proper API.

#### Search users

##### Description

Performs a search of a certain relative kind of user, based on the user that ask for the search. It can retrieve 
all of users, followers or users followed by the requesting user that match with a search criteria. The 'all' user 
relative type does not need user authentication. If the search field is empty, the records are not discriminated. 
Records are served into groups of a certain size called pages. You can select the group size and what group get in 
a call.

This endpoint also return how much records were found with the search criteria.

##### Endpoint

`/v1/api/social-network/users/search`

##### Headers

* `Authorization`

It is optional when `user_relative_type` parameter is equals to 'all'.

##### Method

GET

##### Params

All of the following parameters are optional. It has default values.

* `user_relative_type`: string.

This parameter set what relative type of user to search for. It can be all kind of users (`all`), followers of the user
(`followers`) or the users that the user follow (`followed`). Default `all`.

* `offset`: int.

The size of the group of records to retrieve. Default `10`.

* `page`: int.

The number of the group to retrieve. Pages starts at `0`, what is also the default value.

* `search`: string.

A phrase containing keywords to perform the search. Default is an empty string.

* `asc`: int.

If records are retrieved in ascending order. Default `1`. Use `0` for false.

##### Response data-structure

```json
{
  "users": [
    {
      "username": "person 4",
      "firstname": "person 4 firstname",
      "lastname": "person 4 lastname",
      "profile_img_src": ""
    },
    {
      "username": "person 3",
      "firstname": "person 3 firstname",
      "lastname": "person 3 lastname",
      "profile_img_src": ""
    }
  ],
  "total_records": 4
}
```

##### Codes

No particular codes.

#### Get public user types

##### Description

Return an object containing an array of names and ids of the public user types. Useful as part of the sign up flow.

##### Endpoint

`/v1/api/social-network/users/types`

##### Headers

Not more than mandatories.

##### Method

GET

##### Params

Void

##### Response data-structure

```json
{
  "user_types": [
    {
      "name": "Estudiante",
      "id": 1
    },
    {
      "name": "Invitado",
      "id": 3
    }
  ]
}
```

##### Codes

No particular codes.

#### Get majors data

##### Description

Return an object containing an array of names and ids of avaliable majors. Useful as part of the sign up flow.

##### Endpoint

`/v1/api/social-network/users/majors`

##### Headers

Not more than mandatories.

##### Method

GET

##### Params

Void

##### Response data-structure

```json
{
  "majors": [
    {
      "id": 1,
      "name": "Data Engineering"
    },
    {
      "id": 2,
      "name": "Environmental Engineering"
    }
  ]
}
```

##### Codes

No particular codes.

#### Set follower

##### Description

Makes the requesting user `follow` or `unfollow` a target user. When the action is `unfollow`,
the process just tries to remove the follower relationship if exists, no matter if the requesting user
or the target user exists.

##### Endpoint

`/v1/api/social-network/users/set-follower-for/:username/:action`

##### Headers

Not more than mandatories.

##### Method

GET

##### Params

###### Route

* username: The username of the target user.
* action: A string [follow|unfollow] representing the action to perform.

##### Response data-structure

No data is returned.

```json
{}
```

##### Codes

When the action is `follow`:

1. The target user does not exists.
2. The requesting user does not exists.
3. The requesting user is already following the target user.

#### Update profile image

##### Description

Update the profile image of the requesting user.

##### Endpoint

`/v1/api/social-network/users/update-profile-image`

##### Headers

* `Content-Type`: multipart/form-data
* `Authorization`

##### Method

PUT

##### Params

* `image`: blob. The new image for the group.

##### Response data-structure

```json
{
  "image_src": "https://res.cloudinary.com/user-cloud/image/upload/v123123123/adfadfa2sf3hr4sth4w.jpg"
}
```

##### Codes

1. The user does not exist.

### Groups

#### Get information of a group

##### Description

Return information about a certain group.

##### Endpoint

`/v1/api/social-network/groups/group/:group_id/information`

##### Headers

Not more than mandatories.

##### Method

GET

##### Params

* `group_id`: the id of the group to request. Replace this label by the id in the url.

##### Response data-structure

```json
{
  "group_data": {
    "owner_firstname": "Jhon",
    "owner_lastname": "Doe",
    "owner_username": "jhondoe",
    "owner_profile_img_src": "",
    "group_name": "Engineering",
    "group_image_src": "",
    "group_description": "Python where we can, C++ where we must.",
    "group_visibility": "public",
    "group_created_at": "2021-07-04T22:37:15.000Z"
  },
  "permissions": [
    {
      "id": 1,
      "name": "Permitir publicaciones",
      "codename": "allow_posts",
      "granted": 1
    },
    {
      "id": 2,
      "name": "Permitir comentarios",
      "codename": "allow_comments",
      "granted": 0
    }
  ],
  "tags": [
    {
      "tag": "Ciencia"
    }
  ]
}
```

##### Codes

1. Group doesn't exists. 

#### Search Groups

##### Description

Performs a search of certain relative kind of group, based on the user that ask for the search. It can retrieve all groups 
or only the groups (public and private) that user belongs to, that match with a search criteria. The 'all' group relative 
type does not need user authentication. If the search field is empty the records are not discriminated. Records are served 
in groups of a certain size (determined by offset) called pages. You can select the offset size and what page get in a call.

This endpoint also return how much records were found with the search criteria.

##### Endpoint

`/v1/api/social-network/groups/search`

##### Headers

* `Authorization`

It is optional when `group_relative_type` parameter is equals to 'all'.

##### Method

GET

##### Params

All the following parameters are optional. It has default values.

* `group_relative_type`:

This parameter set what relative type of group to search for. It can be all kind of groups (`all`) or the groups that user belongs 
to (`user`). Default (`all`).

* `search`:

A phrase containing keywords to perform the search. The keywords are related to the name, description and tags of the group. 
Default is an empty string.

* `offset`:

The size of the group of records to retrieve. Default `10`.

* `page`:

The number of the group of records to retrieve. Page start at `0`, what is also the default value.

* `asc`:

If the records are retrieved in ascending order. Default `1`. Use `0` for false.


##### Response data-structure

```json
{
  "groups": [
    {
      "id": 4,
      "name": "Group 4",
      "image_src": "",
      "description": "This is the Group 4"
    },
    {
      "id": 3,
      "name": "Group 3",
      "image_src": "",
      "description": "This is the Group 3"
    }
  ],
  "total_records": 4
}
```

##### Codes

No particular codes.

#### Create a group

##### Description

Creates a new group associating the requesting user as owner.

##### Endpoint

`/v1/api/social-network/groups/create`

##### Headers

* Authorization

##### Method

POST

##### Params

* `group_name`: string. The name of the group. 
* `description`: string. Group description, optional.
* `visibility`: string. If public or private. Posible values [`public`|`private`]
* `permissions`: Array\<int>. An array of permission ids. See [here](#) to request available permissions.
* `tags`: Array\<string>. An array of strings representing tags that will be used to appear in searches.

##### Response data-structure

```json
{
  "group_id": 8
}
```

##### Codes

1. User owner does not exists.
2. Visibility not allowed.
3. Permission does not exists

#### Switch group notifications

##### Description

Turn on or turn off the group notifications.

##### Endpoint

`/v1/api/social-network/groups/group/:group_id/switch-notifications`

##### Headers

* `Authorization`

##### Method

PUT

##### Params

* `group_id`: int.

The id of the group to request. Replace this label by the id in the url.

* `state`: int.

New state of the group notifications. Use `0` to turn off or `1` to turn on the notifications.

##### Response data-structure

No particular response data-structure.

##### Codes

1. User doesn't exist in the group memberships or the group doesn't exist.
2. Group notifications are already in that state.

#### Update group image

##### Description

Update the group image. To do that the user requesting must be the group owner.

##### Endpoint

`/v1/api/social-network/groups/group/:group_id/update-image`

##### Headers

* `Content-Type`: multipart/form-data
* `Authorization`

##### Method

PUT

##### Params

* `group_id`: int. The id of the group to request. Replace this label by the id in the url.
* `image`: blob. The new image for the group.

##### Response data-structure

```json
{
  "image_src": "https://res.cloudinary.com/user-cloud/image/upload/v123123123/adfadfa2sf3hr4sth4w.jpg"
}
```

##### Codes

1. The group does not exist.
2. Permission denied. You are not the group owner.

#### Add a user to a group

##### Description

Add a user to a specific group.

##### Endpoint

`/v1/api/social-network/groups/group/:group_id/add-user`

##### Headers

* `Authorization`

##### Method

POST

##### Params

* `group_id`: int.

Id of the group the user wants to be part of.

##### Response data-structure

No particular response data-structure.

##### Codes

1. Group does not exist.
2. The user is already a member of the group.

#### Get available permissions for groups

##### Description

Return the available permissions that can be assigned to a group.

##### Endpoint

`/v1/api/social-network/groups/available-permissions`

##### Headers

Not more than mandatories.

##### Method

GET

##### Params

Void

##### Response data-structure

```json
{
  "group_permissions": [
    {
      "id": 1,
      "name": "Permitir publicaciones",
      "codename": "allow_posts"
    },
    {
      "id": 2,
      "name": "Permitir comentarios",
      "codename": "allow_comments"
    }
  ]
}
```

##### Codes

No particular codes.

#### Create group post

##### Description

Create a new group post, with a content and/or image.

Or shares a user post or public group post as group post, with an optional content. 
If the referenced post id of the shared post has an integer positive number, the 
referenced post id of the new group post that is going to be saved will be the id 
of the root post.

##### Endpoint

`/v1/api/social-network/groups/group/:group_id/post`

##### Headers

* `Content-Type`: multipart/form-data
* `Authorization`

##### Method

POST

##### Params

* `group_id`: int. Path parameter.
* `content`: string.
* `image`: blob.
* `referenced_post_id`: int. Id of user post or public group post to share.

##### Response data-structure

```json
{
  "id": 132,
  "username": "akshan",
  "firstname": "Akshan",
  "lastname": "",
  "profile_img_src": "",
  "content": "hello",
  "img_src": null,
  "post_type": "group",
  "like_counter": 1,
  "created_at": "2021-08-05T05:00:00.000Z",
  "liked_by_user": false,
  "group_name": "Grupo 1 del usuario 1",
  "group_id": 1,
  "referenced_post_id": 105,
  "referenced_post": {
    "id": 105,
    "username": "irelia",
    "firstname": "Irelia",
    "lastname": "",
    "profile_img_src": "",
    "content": "Post de Irelia con imagen",
    "img_src": "https://res.cloudinary.com/someone-cloud/image/upload/v1628174979/bx43wiaiw7fij4udkbqv.jpg",
    "post_type": "user",
    "like_counter": 1,
    "created_at": "2021-08-05T05:00:00.000Z",
    "liked_by_user": false,
    "group_name": null,
    "group_id": null
  }
}
```

##### Codes
* 1: Group does not exist.
* 2: Group does not have [codename] permission.
* 3: No data was sent.
* 4: User is not member of group.
* 5: The post cannot be shared, it belongs to a private group.

#### Create comment in group post

##### Description

Creates a comment made on a post of type 'group'.

The comment can has a content and/or image.

##### Endpoint

`/v1/api/social-network/groups/post/:post_id/make-comment`

##### Headers

* `Content-Type`: multipart/form-data
* `Authorization`

##### Method

POST

##### Params

* URl params
  * `post_id`: int.

* Body params
  * `content`: string.
  * `image`: blob.

##### Response data-structure

```json
{
  "post_id": 13,
  "comment_id": 46,
  "user_id": 31,
  "firstname": "johndoe",
  "lastname": "John",
  "username": "Doe",
  "profile_image_src": "",
  "content": "Comment of John in post with id 13",
  "image_src": "https://res.cloudinary.com/someone-cloud/image/upload/v1629063555/iphacdyujxixgljbq9bg.jpg",
  "created_at": "2021-08-15"
}
```

##### Codes
* 1: The post does not exist or the post does not belong to a group.
* 2: Group does not have [codename] permission.
* 3: No data was sent.
* 4: Forbidden. User cannot comment because does not belong to the group.

#### Get membership information

##### Description

Returns information about the membership of a user related to a certain group.

##### Endpoint

`/v1/api/social-network/groups/group/:group_id/membership-info`

##### Headers

* `Authorization`

##### Method

GET

##### Params

* `group_id`: int.

The id of the group to request. Replace this label by the id in the url.

##### Response data-structure

```json
{
  "is_member": true,
  "is_owner": false,
  "active_notifications": false,
  "created_at": "2021-08-06T05:00:00.000Z"
}
```

##### Codes

1. Group does not exist.

### Posts

#### Get posts for timeline

##### Description

Retrieves a list of publications made by users that the requesting user is following and publications 
that are associated to groups that the requesting user is part of. The publications are sorted in 
descending order according to their creation date. Records are served into groups of a certain size called pages. 
You can select the group size and what group get in a call.

##### Endpoint

`/v1/api/social-network/posts/timeline`

##### Headers

* `Authorization`

##### Method

GET

##### Params

The following two parameters are optional. It has default values.

* `offset`: int.

The size of the group of records to retrieve. Default `10`.

* `page`: int.

The number of the group to retrieve. Pages starts at `0`, what is also the default value.

##### Response data-structure

```json
{
  "posts": [
    {
      "id": 16,
      "username": "user one",
      "firstname": "user one",
      "lastname": "user one",
      "profile_img_src": "",
      "content": "Post of user one. This is a shared post",
      "img_src": "",
      "post_type": "user",
      "like_counter": 1,
      "created_at": "2021-07-18T05:00:00.000Z",
      "liked_by_user": false,
      "group_name": null,
      "group_id": null,
      "referenced_post": {
        "id": 5,
        "username": "user two",
        "firstname": "user two",
        "lastname": "user two",
        "profile_img_src": "",
        "content": "Post of user two. Marked favorite by the user requesting.",
        "img_src": "https://res.cloudinary.com/ajulian-cloud/image/upload/v1626619985/programming-meme_jni2ji.jpg",
        "post_type": "user",
        "like_counter": 1,
        "created_at": "2021-07-18T05:00:00.000Z",
        "liked_by_user": true,
        "group_name": null,
        "group_id": null
      }
    },
    {
      "id": 9,
      "username": "user two",
      "firstname": "user two",
      "lastname": "user two",
      "profile_img_src": "",
      "content": "Second Post of user two. Marked favorite by the user requesting.",
      "img_src": null,
      "post_type": "group",
      "like_counter": 1,
      "created_at": "2021-07-12T05:00:00.000Z",
      "liked_by_user": true,
      "group_name": "Random group",
      "group_id": 1,
      "referenced_post": null
    }
  ],
  "total_records": 7
}
```

##### Codes

No particular codes.

#### Get data of one publication

##### Description

Retrieves the data of one publication. If the publication belongs to a private group, the user must be 
authenticated and authorized to see the content (be member of the group), in other cases the 
authentication is optional, the response add a field indicating if the user requesting likes the post 
only if the user is authenticated.

##### Endpoint

`/v1/api/social-network/posts/post/:post_id`

##### Headers


* `Authorization`. This header is optional, except if the post belongs to a private group then is mandatory.

##### Method

GET

##### Params

* `post_id`: int.

Publication that the user is requesting.

##### Response data-structure

```json
{
  "id": 16,
  "username": "anton",
  "firstname": "anton",
  "lastname": "anton",
  "profile_img_src": "",
  "content": "Shared post",
  "img_src": "",
  "post_type": "user",
  "like_counter": 1,
  "created_at": "2021-07-18T05:00:00.000Z",
  "liked_by_user": false,
  "group_name": null,
  "group_id": null,
  "referenced_post": {
    "id": 5,
    "username": "tars",
    "firstname": "tars",
    "lastname": "tars",
    "profile_img_src": "",
    "content": "Post of tars. Marked as favorite by the user requesting.",
    "img_src": null,
    "post_type": "user",
    "like_counter": 1,
    "created_at": "2021-07-18T05:00:00.000Z",
    "liked_by_user": true,
    "group_name": null,
    "group_id": null
}
```

##### Codes

* 1: Unauthenticated. User must authenticate to get the requested response.
* 2: Unauthorized. The requested post belongs to a private group to which the user requesting doesn't belong.
* 3: Resource not found.

#### Get favorite posts of user

##### Description

Retrieves a list of favorite publications of a user.
The publications are sorted in descending order according to their creation date. 
Records are served into groups of a certain size called pages. 
You can select the group size and what group get in a call.

##### Endpoint

`/v1/api/social-network/posts/favorite`

##### Headers

* `Authorization`

##### Method

GET

##### Params

The following two parameters are optional. It has default values.

* `offset`: int.

The size of the group of records to retrieve. Default `10`.

* `page`: int.

The number of the group to retrieve. Pages starts at `0`, what is also the default value.

##### Response data-structure

```json
{
  "favorite_posts": [
    {
      "id": 16,
      "username": "user one",
      "firstname": "user one",
      "lastname": "user one",
      "profile_img_src": "",
      "content": "Post of user one. This is a shared post",
      "img_src": "",
      "post_type": "user",
      "like_counter": 2,
      "created_at": "2021-07-18T05:00:00.000Z",
      "group_name": null,
      "group_id": null,
      "referenced_post": {
        "id": 5,
        "username": "user two",
        "firstname": "user two",
        "lastname": "user two",
        "profile_img_src": "",
        "content": "Post of user two. Marked favorite by the user requesting.",
        "img_src": "https://res.cloudinary.com/ajulian-cloud/image/upload/v1626619985/programming-meme_jni2ji.jpg",
        "post_type": "user",
        "like_counter": 1,
        "created_at": "2021-07-18T05:00:00.000Z",
        "group_name": null,
        "group_id": null
      }
    },
    {
      "id": 9,
      "username": "user two",
      "firstname": "user two",
      "lastname": "user two",
      "profile_img_src": "",
      "content": "Second Post of user two. Marked favorite by the user requesting.",
      "img_src": null,
      "post_type": "group",
      "like_counter": 3,
      "created_at": "2021-07-12T05:00:00.000Z",
      "group_name": "Random group",
      "group_id": 1,
      "referenced_post": null
    }
  ],
  "total_records": 7
}
```

##### Codes

No particular codes.

#### Get comments of a post

##### Description

Retrieves a list of comments for a specific post.
Comments are sorted in descending order according to the creation date.
Records are served into groups of a certain size called pages. 
You can select the group size and what group get in a call.

##### Endpoint

`/v1/api/social-network/posts/post/:post_id/comments`

##### Headers

* `Authorization`

##### Method

GET

##### Params

###### URL Parameter

* `post_id`: int.

Publication that the user is requesting.

###### Query Parameter

The following two parameters are optional. It has default values.

* `offset`: int.

The size of the group of records to retrieve. Default `10`.

* `page`: int.

The number of the group to retrieve. Pages starts at `0`, what is also the default value.

##### Response data-structure

```json
{
  "comments": [
    {
      "post_id": 4,
      "user_id": 1,
      "firstname": "User 1",
      "lastname": "User 1",
      "username": "user1",
      "profile_img_src": "",
      "content": "Comment of user 1 in post with id 4",
      "image_src": null,
      "created_at": "2021-07-26T20:16:09.000Z"
    },
    {
      "post_id": 4,
      "user_id": 2,
      "firstname": "User 2",
      "lastname": "User 2",
      "username": "user2",
      "profile_img_src": "",
      "content": "Comment of user 2 in post with id 4",
      "image_src": null,
      "created_at": "2021-07-26T20:16:09.000Z"
    }
  ],
  "total_records": 4
}
```

##### Codes

* 1: Unauthenticated. User must authenticate to get the requested response.
* 2: Unauthorized. The requested post belongs to a private group to which the user requesting doesn't belong.
* 3: Resource not found.

#### Get publications of a certain group

##### Description

Given a group id, return the most recent publications made in the requested group. 

The result has pagination, with 10 post by page and the first group of posts by 
default, these 2 parameters can be modified.

##### Endpoint

`/v1/api/social-network/posts/group/:group_id`

##### Headers

* `Authorization`

##### Method

GET

##### Params

###### URL Parameter

* `group_id`: int.

Group that the user is requesting.

###### Query Parameter

The following two parameters are optional. It has default values.

* `offset`: int.

The size of the group of records to retrieve. Default `10`.

* `page`: int.

The number of the group to retrieve. Pages starts at `0`, what is also the default value.

##### Response data-structure

```json
{
  "group_posts": [
    {
      "id": 142,
      "username": "user2",
      "firstname": "User 2 name",
      "lastname": "User 2 lastname",
      "profile_img_src": "",
      "content": "User 2 shares post of user 1 with id 141 in group 2",
      "img_src": null,
      "post_type": "group",
      "created_at": "2021-08-07T05:00:00.000Z",
      "like_counter": 1,
      "liked_by_user": false,
      "group_name": "Group 2 of user 1",
      "group_id": 2,
      "referenced_post": {
        "id": 141,
        "username": "user 1",
        "firstname": "User 1 name",
        "lastname": "User 1 lastname",
        "profile_img_src": "",
        "content": "Post of user 1. User post",
        "img_src": "https://res.cloudinary.com/someone-cloud/image/upload/v1628376661/mkqghrm6ihpv4dt2jd0y.jpg",
        "post_type": "user",
        "like_counter": 1,
        "created_at": "2021-08-07T05:00:00.000Z",
        "liked_by_user": false,
        "group_name": null,
        "group_id": null
      }
    },
    {
      "id": 144,
      "username": "user 31",
      "firstname": "User 31 name",
      "lastname": "User 31 lastname",
      "profile_img_src": "",
      "content": "Post of user 31 in group 2",
      "img_src": "",
      "post_type": "group",
      "created_at": "2021-08-07T05:00:00.000Z",
      "like_counter": 2,
      "liked_by_user": true,
      "group_name": "Group 2 of user 1",
      "group_id": 2,
      "referenced_post": null
    },
    {
      "id": 146,
      "username": "user31",
      "firstname": "User 31 name",
      "lastname": "User 31 lastname",
      "profile_img_src": "",
      "content": "User 30 shares post of user 2 (in group 1, with id 145) in group 2",
      "img_src": null,
      "post_type": "group",
      "created_at": "2021-08-08T05:00:00.000Z",
      "like_counter": 1,
      "liked_by_user": false,
      "group_name": "Group 2 of user 1",
      "group_id": 2,
      "referenced_post": {
        "id": 145,
        "username": "user2",
        "firstname": "User 2 name",
        "lastname": "User 2 lastname",
        "profile_img_src": "",
        "content": "Post of user 2 in group 1",
        "img_src": "https://res.cloudinary.com/someone-cloud/image/upload/v1628436840/awjdp1chroaofshxjyvj.jpg",
        "post_type": "group",
        "like_counter": 1,
        "created_at": "2021-08-08T05:00:00.000Z",
        "liked_by_user": false,
        "group_name": "Group 1 of user 1",
        "group_id": 1
      }
    }
  ],
  "total_records": 14
}
```

##### Codes

* 1: Group does not exist.
* 2: Forbidden. User is not member of the private group.

#### Get publication of a user

##### Description

Retrieves a list of publications that a user has made in their profile.
The publications are sorted in descending order according to their creation date. 
Records are served into groups of a certain size called pages. 
You can select the group size and what group get in a call.

##### Endpoint

`/v1/api/social-network/posts/user/:username`

##### Headers

* `Authorization`

##### Method

GET

##### Params

###### URL Parameters

* `username`: string.

The target user from which the requesting user wants to retrieve publications.

###### Query Parameters

The following two parameters are optional. It has default values.

* `offset`: int.

The size of the group of records to retrieve. Default `10`.

* `page`: int.

The number of the group to retrieve. Pages starts at `0`, what is also the default value.

##### Response data-structure

```json
{
  "posts": [
    {
      "id": 16,
      "username": "user one",
      "firstname": "user one",
      "lastname": "user one",
      "profile_img_src": "",
      "content": "Post of user one. This is a shared post",
      "img_src": "",
      "post_type": "user",
      "like_counter": 2,
      "created_at": "2021-07-18T05:00:00.000Z",
      "group_name": null,
      "group_id": null,
      "referenced_post": {
        "id": 5,
        "username": "user two",
        "firstname": "user two",
        "lastname": "user two",
        "profile_img_src": "",
        "content": "Post of user two. Marked favorite by the user requesting.",
        "img_src": "https://res.cloudinary.com/ajulian-cloud/image/upload/v1626619985/programming-meme_jni2ji.jpg",
        "post_type": "user",
        "like_counter": 1,
        "created_at": "2021-07-18T05:00:00.000Z",
        "group_name": null,
        "group_id": null
      }
    },
    {
      "id": 9,
      "username": "user two",
      "firstname": "user two",
      "lastname": "user two",
      "profile_img_src": "",
      "content": "Second Post of user two. Marked favorite by the user requesting.",
      "img_src": null,
      "post_type": "group",
      "like_counter": 3,
      "created_at": "2021-07-12T05:00:00.000Z",
      "group_name": "Random group",
      "group_id": 1,
      "referenced_post": null
    }
  ],
  "total_records": 7
}
```

##### Codes

No particular codes.
